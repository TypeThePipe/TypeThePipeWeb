<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">
  <meta name="robots" content="index,follow">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Carlos Vecina">

  
  
  
    
  
  <meta name="description" content="Unlock the Full Potential of Polars for Seamless JSON Data Handling.">

  
  <link rel="alternate" hreflang="en-us" href="/vizs-and-tips/python-polars-json-manipulation/">

  


  
  
  
  <meta name="theme-color" content="#0294A5">
  

  
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css" integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin="anonymous">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      
        
      

      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=G-BHP7JGTF0S"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'G-BHP7JGTF0S', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu9e801daf4e49b28938f4da726192ad03_202286_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu9e801daf4e49b28938f4da726192ad03_202286_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/vizs-and-tips/python-polars-json-manipulation/">

  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="TypeThePipe">
  <meta property="og:url" content="/vizs-and-tips/python-polars-json-manipulation/">
  <meta property="og:title" content="Mastering Python Polars json manipulation. Do it in an easy and robust way! | TypeThePipe">
  <meta property="og:description" content="Unlock the Full Potential of Polars for Seamless JSON Data Handling."><meta property="og:image" content="/vizs-and-tips/python-polars-json-manipulation/featured.png">
  <meta property="twitter:image" content="/vizs-and-tips/python-polars-json-manipulation/featured.png"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2023-10-09T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2023-10-09T00:00:00&#43;00:00">
  

  



  


  







  <title>Mastering Python Polars json manipulation. Do it in an easy and robust way! | TypeThePipe</title>
  <script async defer src="https://tools.luckyorange.com/core/lo.js?site-id=10579286"></script>
  
  
<script>var ezoicId = 473828; </script>
<script type="text/javascript" src="//go.ezoic.net/ezoic/ezoic.js"></script>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  






  


<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/"><img src="/images/logo_hu98b613e11a8f47913471a1a46318bc6c_19561_0x70_resize_lanczos_2.png" alt="TypeThePipe"></a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/"><img src="/images/logo_hu98b613e11a8f47913471a1a46318bc6c_19561_0x70_resize_lanczos_2.png" alt="TypeThePipe"></a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#vizstips"><span>Vizs & Tips</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#people"><span>About Us</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#mentorship"><span>Mentorship Program</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      

      

    </ul>

  </div>
</nav>


  


        <article class="article">
            





















  
  
    
  


<div class="article-container pt-3">
  <h1>Mastering Python Polars json manipulation. Do it in an easy and robust way!</h1>

  
  <p class="page-subtitle">Unlock the Full Potential of Polars for Seamless JSON Data Handling</p>
  

  


<div class="article-metadata">

  
  
  
  
  <div>
    

  
  <span><a href="/authors/carlos-vecina/">Carlos Vecina</a></span>
  </div>
  
  

  

  

  

  
  
  

  
  
  
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/python/">Python</a>, <a href="/categories/tips/">Tips</a></span>
  

</div>

  














</div>





            <div class="article-container">
              <div class="article-style">
                
<script src="/vizs-and-tips/python-polars-json-manipulation/index_files/header-attrs/header-attrs.js"></script>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<p><img src="featured.png" height="250px" width="400px" alt="Polars Python with sort dataframes message"/></p>
<p>As you may know, the JSON format comes in handy for various programming tasks, ranging from configuration files to storing model weights and parameters, making it a versatile choice. With Polars, you can effortlessly load, manipulate, and write JSON files, streamlining your data handling processes.</p>
<p>JSON (JavaScript Object Notation) is a user-friendly data format, known for its simplicity and readability, making it perfect for a variety of applications. Its versatility and compatibility with numerous programming languages make it a powerhouse for modern data representation and exchange.</p>
<p><br></p>
<div id="how-to-work-with-json-files-in-polars" class="section level1">
<h1>How to work with JSON files in Polars</h1>
<p>Among the dynamic world of data manipulation and analysis, there is a Python library that’s shaking things up: it is the already treated in TypeThePipe, Polars. While data processing is frequently associated with the Pandas library, Polars emerges as a star, boasting lightning-fast performance and a rich set of features. What sets Polars apart is it ability to handle JSON data, making it an indispensable asset for individuals working with intricate and ever-changing data structures. In this blog post, we’re about to unravel the wonders of JSON manipulation and reveal how this library has the power to serialize / deserialize JSON DataFrames, LazyDataFrames and Expresions.</p>
<p><br></p>
<div id="reading-json-with-polars-read_json" class="section level2">
<h2><strong>Reading JSON with Polars read_json</strong></h2>
<p>Polars <code>read_json</code> method is a practical tool for working with JSON data. It allows you to easily import JSON data and convert it into a structured DataFrame or LazyDataFrame, simplifying the process of data analysis.</p>
<p>Also, you can add schema and schema override function parameters. Even if you’re dealing with complex or straightforward JSON structures, this method efficiently handles the conversion, saving you time and effort. It’s a useful feature making data manipulation more reliable and robust.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>config_json <span class="op">=</span> {</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    <span class="st">&quot;model_type&quot;</span>: <span class="st">&quot;regression&quot;</span>,</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    <span class="st">&quot;model_reg_vars&quot;</span>: {</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>        <span class="st">&quot;price&quot;</span>: <span class="st">&quot;continuous&quot;</span>,</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>        <span class="st">&quot;zip_range&quot;</span>: <span class="st">&quot;categorical&quot;</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>    },</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>    <span class="st">&quot;model_dep_var&quot;</span>: {</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>        <span class="st">&quot;y&quot;</span>: <span class="st">&quot;categorical&quot;</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>    },</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>    <span class="st">&quot;model_version_tag&quot;</span>: <span class="fl">1.19</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>}</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">&#39;data.json&#39;</span>, <span class="st">&#39;w&#39;</span>, encoding<span class="op">=</span><span class="st">&#39;utf-8&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>    json.dump(config_json, f, indent<span class="op">=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="im">import</span> polars <span class="im">as</span> pl</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>df_from_json <span class="op">=</span> (</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>pl.read_json(<span class="st">&quot;data.json&quot;</span>,</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>    schema<span class="op">=</span>{</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>        <span class="st">&#39;model_type&#39;</span>: pl.Utf8, </span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>        <span class="st">&#39;model_reg_vars&#39;</span>: pl.Struct([pl.Field(<span class="st">&#39;price&#39;</span>, pl.Utf8), pl.Field(<span class="st">&#39;zip_range&#39;</span>, pl.Utf8)]), </span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>        <span class="st">&#39;model_dep_var&#39;</span>: pl.Struct([pl.Field(<span class="st">&#39;y&#39;</span>, pl.Utf8)]), </span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>        <span class="st">&#39;model_version_tag&#39;</span>: pl.Float64</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>        }</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>    )</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>pl.read_json(<span class="st">&quot;data.json&quot;</span>).schema</span></code></pre></div>
<pre><code>## {&#39;model_type&#39;: Utf8, &#39;model_reg_vars&#39;: Struct([Field(&#39;price&#39;, Utf8), Field(&#39;zip_range&#39;, Utf8)]), &#39;model_dep_var&#39;: Struct([Field(&#39;y&#39;, Utf8)]), &#39;model_version_tag&#39;: Float64}</code></pre>
<p><br></p>
<div id="unesting-json-fields-from-dataframe-columns" class="section level3">
<h3>Unesting JSON fields from DataFrame columns</h3>
<p>Several strategies can be taken for unnesting JSON fields from a POlars DataFrame. First one one can <code>rename_fields</code> as Struct method.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>model_reg_col_name <span class="op">=</span> <span class="st">&quot;model_reg_vars&quot;</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>struct_names <span class="op">=</span> [<span class="ss">f&#39;</span><span class="sc">{</span>model_reg_col_name<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">&#39;</span> <span class="cf">for</span> i <span class="kw">in</span> df_from_json[model_reg_col_name].struct.fields]</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>(</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    df_from_json</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>    .select(pl.col(model_reg_col_name).struct.rename_fields(struct_names))</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>    .unnest(model_reg_col_name)</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>)</span></code></pre></div>
<div><style>
.dataframe > thead > tr > th,
.dataframe > tbody > tr > td {
  text-align: right;
}
</style>
<small>shape: (1, 2)</small><table border="1" class="dataframe"><thead><tr><th>model_reg_vars_price</th><th>model_reg_vars_zip_range</th></tr><tr><td>str</td><td>str</td></tr></thead><tbody><tr><td>&quot;continuous&quot;</td><td>&quot;categorical&quot;</td></tr></tbody></table></div>
<p>Another way if you have few nested fields and know their name, you can simply use <code>select()</code> and access them by <code>struct.field()</code></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>df_from_json.select(</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>    pl.<span class="bu">all</span>().exclude(<span class="st">&quot;model_reg_vars&quot;</span>),</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>    pl.col(<span class="st">&quot;model_reg_vars&quot;</span>).struct.field(<span class="st">&quot;zip_range&quot;</span>),</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>    pl.col(<span class="st">&quot;model_reg_vars&quot;</span>).struct.field(<span class="st">&quot;price&quot;</span>)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>)</span></code></pre></div>
<div><style>
.dataframe > thead > tr > th,
.dataframe > tbody > tr > td {
  text-align: right;
}
</style>
<small>shape: (1, 5)</small><table border="1" class="dataframe"><thead><tr><th>model_type</th><th>model_dep_var</th><th>model_version_tag</th><th>zip_range</th><th>price</th></tr><tr><td>str</td><td>struct[1]</td><td>f64</td><td>str</td><td>str</td></tr></thead><tbody><tr><td>&quot;regression&quot;</td><td>{&quot;categorical&quot;}</td><td>1.19</td><td>&quot;categorical&quot;</td><td>&quot;continuous&quot;</td></tr></tbody></table></div>
<p><br></p>
</div>
<div id="unnesting-several-columns-in-polars" class="section level3">
<h3>Unnesting several columns in Polars</h3>
<p>Unnesting several struct columns in Polars is a task that often arises when dealing with complex and nested data. Polars provides a convenient way to do this by using the unnest method on multiple struct columns simultaneously. This operation essentially “flattens” the nested structures, making the data more accessible for analysis and manipulation. By specifying the column names that need to be unnested, you can efficiently work with the data contained within those structures, simplifying your data processing tasks in Polars.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>df_from_json.unnest(<span class="st">&quot;model_dep_var&quot;</span>, <span class="st">&quot;model_reg_vars&quot;</span>)</span></code></pre></div>
<div><style>
.dataframe > thead > tr > th,
.dataframe > tbody > tr > td {
  text-align: right;
}
</style>
<small>shape: (1, 5)</small><table border="1" class="dataframe"><thead><tr><th>model_type</th><th>price</th><th>zip_range</th><th>y</th><th>model_version_tag</th></tr><tr><td>str</td><td>str</td><td>str</td><td>str</td><td>f64</td></tr></thead><tbody><tr><td>&quot;regression&quot;</td><td>&quot;continuous&quot;</td><td>&quot;categorical&quot;</td><td>&quot;categorical&quot;</td><td>1.19</td></tr></tbody></table></div>
<p>This is cool as long as the nested fields names don’t collide. If so, <code>unnest</code> function is expected to fail.</p>
<p>A hacky way to do it avoiding duplicated columns errors are this one proposed in SO question response. It is quite hacker because you should monkey patch Polars DataFrame <code>unnest</code> function. Doing it without a clear strategy, could lead to inconsistencies across your project code.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="kw">def</span> unnest(<span class="va">self</span>, columns, <span class="op">*</span>more_columns, prefix<span class="op">=</span><span class="va">None</span>, suffix<span class="op">=</span><span class="va">None</span>, col_prefix<span class="op">=</span><span class="va">False</span>, col_suffix<span class="op">=</span><span class="va">False</span>, drop_existing<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(columns, <span class="bu">str</span>):</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>        columns <span class="op">=</span> [columns]</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>    <span class="cf">if</span> more_columns:</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>        columns <span class="op">=</span> <span class="bu">list</span>(columns)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>        columns.extend(more_columns)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>    <span class="co">#check to see if any new parameters are used, if not just return as is current behavior</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>    <span class="cf">if</span> drop_existing<span class="op">==</span><span class="va">False</span> <span class="kw">and</span> <span class="kw">not</span> (prefix <span class="kw">or</span> suffix <span class="kw">or</span> col_prefix <span class="kw">or</span> col_suffix):</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>._from_pydf(<span class="va">self</span>._df.unnest(columns))</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>    final_prefix<span class="op">=</span><span class="st">&quot;&quot;</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>    final_suffix<span class="op">=</span><span class="st">&quot;&quot;</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>    </span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> columns:</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>        <span class="cf">if</span> col_prefix:</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>            final_prefix<span class="op">=</span>col<span class="op">+</span><span class="st">&quot;_&quot;</span><span class="op">+</span>prefix <span class="cf">if</span> prefix <span class="cf">else</span> col<span class="op">+</span><span class="st">&quot;_&quot;</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>        <span class="cf">if</span> col_suffix:</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>            final_suffix<span class="op">=</span><span class="st">&quot;_&quot;</span><span class="op">+</span>col<span class="op">+</span>suffix <span class="cf">if</span> suffix <span class="cf">else</span> <span class="st">&quot;_&quot;</span><span class="op">+</span>col</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>        tempdf <span class="op">=</span> <span class="va">self</span>[<span class="dv">0</span>].select(col)</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>        innercols <span class="op">=</span> tempdf._from_pydf(tempdf._df.unnest([col])).columns</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>        newcols <span class="op">=</span> [final_prefix<span class="op">+</span>innercol<span class="op">+</span>final_suffix <span class="cf">for</span> innercol <span class="kw">in</span> innercols]</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>        <span class="va">self</span> <span class="op">=</span> (</span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>            <span class="va">self</span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>                .with_columns(pl.col(col).struct.rename_fields(newcols))</span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>                .drop([drop_col <span class="cf">for</span> drop_col <span class="kw">in</span> newcols <span class="cf">if</span> drop_col <span class="kw">in</span> <span class="va">self</span>.columns])</span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>        )</span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">self</span>._from_pydf(<span class="va">self</span>._df.unnest(columns))</span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a>pl.DataFrame.unnest<span class="op">=</span>unnest</span></code></pre></div>
<p><br></p>
<p>This way, you can add programmatically column suffix, as an equivalent of what we have seen in the previous section.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>df_from_json.unnest(<span class="st">&quot;model_dep_var&quot;</span>, <span class="st">&quot;model_reg_vars&quot;</span>, col_suffix<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div><style>
.dataframe > thead > tr > th,
.dataframe > tbody > tr > td {
  text-align: right;
}
</style>
<small>shape: (1, 5)</small><table border="1" class="dataframe"><thead><tr><th>model_type</th><th>price_model_reg_vars</th><th>zip_range_model_reg_vars</th><th>y_model_dep_var</th><th>model_version_tag</th></tr><tr><td>str</td><td>str</td><td>str</td><td>str</td><td>f64</td></tr></thead><tbody><tr><td>&quot;regression&quot;</td><td>&quot;continuous&quot;</td><td>&quot;categorical&quot;</td><td>&quot;categorical&quot;</td><td>1.19</td></tr></tbody></table></div>
<p><br></p>
</div>
</div>
<div id="polars-write_json" class="section level2">
<h2><strong>Polars write_json</strong></h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>df_from_json.write_json()</span></code></pre></div>
<pre><code>## &#39;{&quot;columns&quot;:[{&quot;name&quot;:&quot;model_type&quot;,&quot;datatype&quot;:&quot;Utf8&quot;,&quot;values&quot;:[&quot;regression&quot;]},{&quot;name&quot;:&quot;model_reg_vars&quot;,&quot;datatype&quot;:{&quot;Struct&quot;:[{&quot;name&quot;:&quot;price&quot;,&quot;dtype&quot;:&quot;Utf8&quot;},{&quot;name&quot;:&quot;zip_range&quot;,&quot;dtype&quot;:&quot;Utf8&quot;}]},&quot;values&quot;:[{&quot;name&quot;:&quot;price&quot;,&quot;datatype&quot;:&quot;Utf8&quot;,&quot;values&quot;:[&quot;continuous&quot;]},{&quot;name&quot;:&quot;zip_range&quot;,&quot;datatype&quot;:&quot;Utf8&quot;,&quot;values&quot;:[&quot;categorical&quot;]}]},{&quot;name&quot;:&quot;model_dep_var&quot;,&quot;datatype&quot;:{&quot;Struct&quot;:[{&quot;name&quot;:&quot;y&quot;,&quot;dtype&quot;:&quot;Utf8&quot;}]},&quot;values&quot;:[{&quot;name&quot;:&quot;y&quot;,&quot;datatype&quot;:&quot;Utf8&quot;,&quot;values&quot;:[&quot;categorical&quot;]}]},{&quot;name&quot;:&quot;model_version_tag&quot;,&quot;datatype&quot;:&quot;Float64&quot;,&quot;values&quot;:[1.19]}]}&#39;</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>df_from_json.write_json(row_oriented<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<pre><code>## &#39;[{&quot;model_type&quot;:&quot;regression&quot;,&quot;model_reg_vars&quot;:{&quot;price&quot;:&quot;continuous&quot;,&quot;zip_range&quot;:&quot;categorical&quot;},&quot;model_dep_var&quot;:{&quot;y&quot;:&quot;categorical&quot;},&quot;model_version_tag&quot;:1.19}]&#39;</code></pre>
<p>But what about serializing not Polars DataFrames but Polars expressions. It is also possible!</p>
<p><br></p>
</div>
<div id="serialize-polars-expresions-and-lazydataframes" class="section level2">
<h2><strong>Serialize Polars expresions and LazyDataFrames</strong></h2>
<p>Starting from <code>polars &gt;= 0.18.1</code>, it is possible to serialize / deserialize an expression to make it work as follow:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>json_cond_select1 <span class="op">=</span> pl.col(<span class="st">&#39;model_type&#39;</span>).alias(<span class="st">&#39;ml_model_category&#39;</span>).meta.write_json()</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>json_cond_select2 <span class="op">=</span> pl.col(<span class="st">&#39;model_version_tag&#39;</span>).meta.write_json()</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>json_cond_filter1 <span class="op">=</span> (pl.col(<span class="st">&#39;model_version_tag&#39;</span>) <span class="op">==</span> <span class="fl">1.19</span>).meta.write_json()</span></code></pre></div>
<p>The expressions are serializable individually, and the whole <code>expr_config</code> is also serializable.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>expr_config <span class="op">=</span> {</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>     <span class="st">&#39;select&#39;</span>: [</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>        pl.Expr.from_json(json_cond_select1),</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>        pl.Expr.from_json(json_cond_select2),</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>                ],</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>     <span class="st">&#39;filters&#39;</span>: [</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>        pl.Expr.from_json(json_cond_filter1),</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>      ]</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>}</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>(</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>    pl.read_json(<span class="st">&quot;data.json&quot;</span>)</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>    .<span class="bu">filter</span>(pl.all_horizontal(expr_config[<span class="st">&quot;filters&quot;</span>]))</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>    .select(expr_config[<span class="st">&quot;select&quot;</span>])</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>).lazy().write_json()</span></code></pre></div>
<pre><code>## &#39;{&quot;DataFrameScan&quot;:{&quot;df&quot;:{&quot;columns&quot;:[{&quot;name&quot;:&quot;ml_model_category&quot;,&quot;datatype&quot;:&quot;Utf8&quot;,&quot;values&quot;:[&quot;regression&quot;]},{&quot;name&quot;:&quot;model_version_tag&quot;,&quot;datatype&quot;:&quot;Float64&quot;,&quot;values&quot;:[1.19]}]},&quot;schema&quot;:{&quot;inner&quot;:{&quot;ml_model_category&quot;:&quot;Utf8&quot;,&quot;model_version_tag&quot;:&quot;Float64&quot;}},&quot;output_schema&quot;:null,&quot;projection&quot;:null,&quot;selection&quot;:null}}&#39;</code></pre>
<p><br></p>
<div id="stay-updated-on-polars-tips" class="section level3">
<h3><strong>Stay updated on Polars tips</strong></h3>
<p>Hopefully, this post has helped you become familiar with Polars JSON serialization and usage and allowed you to enjoy a showcase of some of its features.</p>
<p>If you want to stay updated…</p>
<!-- Begin Mailchimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="https://csshake.surge.sh/csshake.min.css">
<style type="text/css">
	#mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; width:100%;}
	 #mc_embed_signup .button {
  background-color: #0294A5; /* Green */
  color: white;
  transition-duration: 0.4s;
}
#mc_embed_signup .button:hover {
  background-color: #379392 !important; 
}

</style>
<div id="mc_embed_signup">
<form action="https://typethepipe.us4.list-manage.com/subscribe/post?u=91551f7ed29389a0de4f47665&amp;id=d95c503a48" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
 <div id="mc_embed_signup_scroll">
	<label for="mce-EMAIL"> Suscribe for more Python Polars content!</label>
	<input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="your best email" required>
    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_91551f7ed29389a0de4f47665_d95c503a48" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Submit!" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>

<!--End mc_embed_signup-->
<style>
.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#2e8516;font-weight:bold}.hljs-comment, .hljs-quote {
    color: #0e847b;
    font-style: italic;
}.hljs-number, .hljs-literal, .hljs-variable, .hljs-template-variable, .hljs-tag .hljs-attr {
    color: #008021;
}
</style>
</div>
</div>
</div>

              </div>
              





<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/python/">Python</a>
  
  <a class="badge badge-light" href="/tags/polars/">Polars</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/vizs-and-tips/python-polars-json-manipulation/&amp;text=Mastering%20Python%20Polars%20json%20manipulation.%20Do%20it%20in%20an%20easy%20and%20robust%20way!" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/vizs-and-tips/python-polars-json-manipulation/&amp;t=Mastering%20Python%20Polars%20json%20manipulation.%20Do%20it%20in%20an%20easy%20and%20robust%20way!" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Mastering%20Python%20Polars%20json%20manipulation.%20Do%20it%20in%20an%20easy%20and%20robust%20way!&amp;body=/vizs-and-tips/python-polars-json-manipulation/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/vizs-and-tips/python-polars-json-manipulation/&amp;title=Mastering%20Python%20Polars%20json%20manipulation.%20Do%20it%20in%20an%20easy%20and%20robust%20way!" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Mastering%20Python%20Polars%20json%20manipulation.%20Do%20it%20in%20an%20easy%20and%20robust%20way!%20/vizs-and-tips/python-polars-json-manipulation/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/vizs-and-tips/python-polars-json-manipulation/&amp;title=Mastering%20Python%20Polars%20json%20manipulation.%20Do%20it%20in%20an%20easy%20and%20robust%20way!" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  
    
    





  
  
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <img class="avatar mr-3 avatar-circle" src="/authors/carlos-vecina/carlos-vecina-avatar_hudcecee8c8ed4dd07fd2b73e656fad71c_149347_270x270_fill_lanczos_center_2.png" alt="Carlos Vecina">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/authors/carlos-vecina/">Carlos Vecina</a></h5>
      <h6 class="card-subtitle">Senior Data Scientist at Jobandtalent</h6>
      <p class="card-text">Senior Data Scientist at Jobandtalent  |  AI &amp; Data Science for Business</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/deepchals" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/carlos-vecina/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/CarlosVecina" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://autarponics.com" target="_blank" rel="noopener">
        <i class="fa fa-home"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>


  










  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/vizs-and-tips/python-polars-sort/">Sort in Python Polars. Arrange your DataFrames and Series</a></li>
      
      <li><a href="/vizs-and-tips/upper-strip-python/">How to upper strip in Python</a></li>
      
      <li><a href="/vizs-and-tips/error-cannot-import-name-multihostdsn-from-pydantic-networks/">Fix the error: cannot import name &#39;MultiHostDsn&#39; from &#39;pydantic.networks&#39;</a></li>
      
      <li><a href="/vizs-and-tips/python-polars-selectors-select-multiple-columns/">Efficient Column Selection in Polars: Utilizing Polars Selectors for Python DataFrame Manipulation</a></li>
      
      <li><a href="/vizs-and-tips/python-polars-select-datetime-columns-selector/">Select datetime columns matching time zones with Python Polars selectors. Calculate offset with the new dst_offset.</a></li>
      
    </ul>
  </div>
  


            </div>
        </article>
  

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/python.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js" integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.37431be2d92d7fb0160054761ab79602.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>

    
    

    






  
  
  <div class="container">
    <footer class="site-footer">
  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms and Conditions</a>
    
  </p>
  

  <p class="powered-by">
    

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.
	<a href="https://www.r-bloggers.com/">
	<img border="0" alt="R Bloggers icon" src="/img/r_bloggers.png" width="100" height="100">
	</a>
	<br>
	<a href="https://www.python-bloggers.com/">
	<img border="0" alt="Python Bloggers icon" src="/img/python_logo.png" width="100" height="100">
	</a>
    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
  <style>
    #consent-notice {padding: 1rem 1rem; display: none; text-align: center; position: fixed; bottom: 0; width: calc(100% - 2rem); background: #222; color: rgba(255,255,255,0.8);}
    #consent-notice span {margin-right: 1rem;}
    #consent-notice button {cursor: pointer; display: inline-block; width: auto;}
    #consent-notice span a {color: inherit; text-decoration: underline; text-decoration-color: rgba(255,255,255,0.5);}
    #consent-notice button.btn {margin-left: 0.5rem;}
    #consent-notice button.btn.manage-consent {background: rgba(255,255,255,0.1); font-weight: normal;}
    
    #consent-overlay {position: fixed; left: 0; top: 0; width: 100%; height: 100vh; display: none; background: rgba(0,0,0,0.75); z-index: 999999; overflow: auto; cursor: pointer;}
    #consent-overlay.active {display: flex;}
    #consent-overlay > div {background: white; width: 100%; max-width: 30rem; padding: 1.75rem; margin: auto; cursor: initial;}
    #consent-overlay > div > div {display: flex; align-items: flex-start; margin-bottom: 1rem;}
    #consent-overlay > div > div:last-child {margin: 0;}
    #consent-overlay h3 {padding-top: 0;}
    #consent-overlay input {margin-top: 0.3rem;}
    #consent-overlay label {display: block;}
    #consent-overlay .btn {margin-right: 0.5rem;}
    #consent-overlay button.btn.save-consent {background: rgba(0,0,0,0.6); font-weight: normal;}

    @media (max-width: 767px) {
        #consent-overlay > div {padding: 1.75rem 1rem;}
        #consent-notice span {display: block; padding-top: 3px; margin-bottom: 1.5rem;}
        #consent-notice button.btn {position: relative; bottom: 4px;}
    }
</style>
<div id="consent-notice"><span>We would like to use <a class="manage-consent" href="#manage-consent">third party code</a> to improve the functionality of this website.</span><button class="btn manage-consent">Manage preferences</button><button class="btn deny-consent">Deny</button><button class="btn approve-consent">Allow</button></div>
<div id="consent-overlay">
    <div>
        
            <div>
                <input type="checkbox" id="item0" value="1" name="item0" checked disabled />
                <label for="item0">
                    <h3>Google Anaytics (functional)</h3>
                    <p>This code gives us insight into the number of anonymized people that visit our website, where they are from and what they are clicking on in order to create better content.</p>
                </label>
            </div>
        
            <div>
                <input type="checkbox" id="item1" value="1" name="item1"  />
                <label for="item1">
                    <h3>Marketing</h3>
                    <p>Marketing pourposes cookies.</p>
                </label>
            </div>
        
        <div>
            <button id="save-consent" class="btn save-consent" data-consentvalue="0">Save preferences</button>
            <button class="btn approve-consent">Allow all</button>
        </div>
    </div>
</div>
<script>

    const scripts = [];
    scripts[ 0 ] = "/js/mkt.js";

    function createCookie(name,value,days) {
        var expires = "";
        if (days) {
            var date = new Date();
            date.setTime(date.getTime() + (days*24*60*60*1000));
            expires = "; expires=" + date.toUTCString();
        }
        document.cookie = name + "=" + value + expires + "; path=/";
    }
    function readCookie(name) {
        var nameEQ = name + "=";
        var ca = document.cookie.split(';');
        for(var i=0;i < ca.length;i++) {
            var c = ca[i];
            while (c.charAt(0)==' ') c = c.substring(1,c.length);
            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
        }
        return null;
    }
    function eraseCookie(name) {
        createCookie(name,"",-1);
    }
    function denyAllConsentScripts() {
        var consentValue = "";
        scripts.forEach(function(){
            consentValue = consentValue + "0";
        });
        acceptSomeConsentScripts(consentValue);
    }
    function acceptAllConsentScripts() {
        var consentValue = "";
        scripts.forEach(function(){
            consentValue = consentValue + "1";
        });
        acceptSomeConsentScripts(consentValue);
    }
    function acceptSomeConsentScripts(consentValue) {
        setConsentInputs(consentValue);
        createCookie('consent-settings',consentValue,31);
        document.getElementById('consent-notice').style.display = 'none';
        document.getElementById('consent-overlay').classList.remove('active');
        loadConsentScripts(consentValue);
    }
    function loadConsentScripts(consentValue) {
        scripts.forEach(function(value,key){
            
            if(consentValue[key]=="1") {
                var s = document.createElement('script');
                s.type = 'text/javascript';
                s.src = value;
                document.body.appendChild(s);
            }
        });
    }
    function setConsentInputs(consentValue) {
        var elements = document.querySelectorAll('#consent-overlay input:not([disabled])');
        elements.forEach(function(el,index) {
            if(consentValue[index]=="1") el.checked = true;
            else el.checked = false;
        });
    }
    function setConsentValue() {
        var elements = document.querySelectorAll('#consent-overlay input:not([disabled])');
        var consentValue = "";
        elements.forEach(function(el) {
            if(el.checked) consentValue = consentValue + "1";
            else consentValue = consentValue + "0";
        });
        document.getElementById("save-consent").dataset.consentvalue = consentValue;
    }

    var elements = document.querySelectorAll('#consent-overlay input:not([disabled])');
    elements.forEach(function(el) {
        el.checked = false;
    });

    if(readCookie('consent-settings')) {
        var consentValue = readCookie('consent-settings').toString();
        
        setConsentInputs(consentValue);
        loadConsentScripts(consentValue);
    } else {
        document.getElementById('consent-notice').style.display = 'block';
    }
    var elements = document.querySelectorAll('.manage-consent');
    elements.forEach(function(el) {
        el.addEventListener("click",function() {
            document.getElementById('consent-overlay').classList.toggle('active');
        });
    });
    var elements = document.querySelectorAll('.deny-consent');
    elements.forEach(function(el) {
        el.addEventListener("click",function() {
            denyAllConsentScripts();
        });
    });
    var elements = document.querySelectorAll('.approve-consent');
    elements.forEach(function(el) {
        el.addEventListener("click",function() {
            acceptAllConsentScripts();
        });
    });
    document.getElementById("save-consent").addEventListener("click",function() {
        setConsentValue();
        acceptSomeConsentScripts(this.dataset.consentvalue);
    });
    document.getElementById("consent-overlay").addEventListener("click",function(e) {
        if (!document.querySelector("#consent-overlay > div").contains(e.target)){
            this.classList.toggle('active');
        }
    });
</script>


    
        <script type="text/javascript" src="/js/ga.js"></script>
    

    

</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
